---
import LanderSection from "../../LanderSection.astro";
import H1 from "../../typography/h1.astro";
import QuoteSubTitle from "../../typography/QuoteSubTitle.astro";
type Category =
  "defi"
  | "infrastructure"
  | "interchain token"
  | "wallet"
  | "enterprise"
  | "rwa"
  | "nft"
  | "dex"
  | "interchain native"
  | "";

interface ItemData {
  name: string;
  logo: string;
  cover: string;
  category: Category[]
}

const data: ItemData[] = [
  {name: "Skip", logo: "", cover: "", category: ["nft"]},
  {name: "Landslide", logo: "", cover: "", category: ["nft"]},
  {name: "Bera", logo: "", cover: "", category: ["nft"]},
  {name: "Arbitrum", logo: "", cover: "", category: ["nft"]},
  {name: "Polygon", logo: "", cover: "", category: ["nft"]},
  {name: "Skip", logo: "", cover: "", category: ["nft"]},
  {name: "Landslide", logo: "", cover: "", category: ["nft"]},
  {name: "Bera", logo: "", cover: "", category: ["nft"]},
  {name: "Skip", logo: "", cover: "", category: ["nft"]},
  {name: "Landslide", logo: "", cover: "", category: ["nft"]},
  {name: "Bera", logo: "", cover: "", category: ["nft"]},
  {name: "Arbitrum", logo: "", cover: "", category: ["nft"]},
  {name: "Polygon", logo: "", cover: "", category: ["nft"]},
  {name: "Skip", logo: "", cover: "", category: ["nft"]},
  {name: "Landslide", logo: "", cover: "", category: ["nft"]},
  {name: "Bera", logo: "", cover: "", category: ["nft"]},
];

const categories: Category[] = ["defi", "infrastructure", "interchain token", "wallet", "enterprise", "rwa", "nft", "dex", "interchain native"];
---

<LanderSection>
    <!-- Search Bar -->
    <div class="flex flex-col gap-4 mb-4 w-fit">
        <div class="max-w-[400px] flex flex-col gap-4">
            <H1>Union <span class="text-accent-500">reef</span></H1>
            <QuoteSubTitle>The Union reef is an ocean of possibilities. Check out who is already swimming with us to
                build the modular zk future.
            </QuoteSubTitle>
        </div>
        <label for="searchInput"></label><input
            type="text"
            id="searchInput"
            placeholder="Search by name..."
            class="px-4 py-2 border-2 bg-transparent text-white placeholder-white font-mono"
    />
    </div>

    <div class="grid grid-cols-4 gap-4 mt-8 w-full">
        <!-- Filter Checkboxes -->
        <div class="col-span-1">
            <h2 class="text-xl font-bold uppercase mb-4">Filter</h2>
          {categories.map(category => (
                  <div class="mb-2">
                      <label class="flex items-center font-mono uppercase">
                          <input type="checkbox" value={category} class="mr-2"/>
                        {category}
                      </label>
                  </div>
          ))}
        </div>

        <!-- Cards Grid -->
        <div class="col-span-3 grid grid-cols-3 gap-6">
          {data.map(item => (
                  <div class="border-2 rounded-tl-[6rem] shadow-md rounded-lg overflow-hidden">
                      <img src={item.cover} alt={item.name} class="w-full h-56 object-cover"/>
                      <div class="p-4">
                          <div class="flex w-full justify-between">
                              <p class="text-sm text-gray-600">{item.category}</p>
                              <div class="rounded-full border-2 h-28 w-28">
                                  <img src={item.logo} alt={`${item.name} logo`} class="w-12 h-12 mb-2"/>
                              </div>
                          </div>
                          <h3 class="text-lg font-semibold">{item.name}</h3>
                      </div>
                  </div>
          ))}
        </div>

    </div>
</LanderSection>


<script>
  const searchInput = document.getElementById('searchInput') as HTMLInputElement;
  const checkboxes = document.querySelectorAll('input[type="checkbox"]') as NodeListOf<HTMLInputElement>;
  const cards = document.querySelectorAll('.col-span-3 > div') as NodeListOf<HTMLDivElement>;

  function filterCards(): void {
    const searchTerm = searchInput.value.toLowerCase();
    const selectedCategories = Array.from(checkboxes)
      .filter(cb => cb.checked)
      .map(cb => cb.value);

    cards.forEach(card => {
      const name = card.querySelector('h3')!.textContent!.toLowerCase();
      const category = card.querySelector('p')!.textContent!;

      const matchesSearch = name.includes(searchTerm);
      const matchesCategory = selectedCategories.length === 0 || selectedCategories.includes(category);

      card.style.display = matchesSearch && matchesCategory ? 'block' : 'none';
    });
  }

  searchInput.addEventListener('input', filterCards);
  checkboxes.forEach(checkbox => checkbox.addEventListener('change', filterCards));
</script>